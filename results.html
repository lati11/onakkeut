<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì˜¤ë‚šë ğŸ£ - ì •ì‚°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; }
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; border-radius: 10px; }
        ::-webkit-scrollbar-thumb { background: #888; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #555; }
        .session-row { cursor: pointer; }
        .session-row:hover { background-color: #f9fafb; }
        .session-details td { padding: 0 !important; border-top: 2px solid #e5e7eb; border-bottom: 2px solid #e5e7eb; }
        .details-table { margin: 0; width: 100%; border-collapse: collapse; }
        .details-table th, .details-table td { border-bottom: 1px solid #e5e7eb; }
        .details-table tr:last-child td { border-bottom: none; }
    </style>
</head>
<body class="bg-gray-100">
    <div class="container mx-auto p-4 md:p-8">
        <div class="bg-white rounded-2xl shadow-xl w-full flex flex-col">
            <div class="p-6 border-b">
                <h2 id="page-title" class="text-2xl font-bold text-gray-800">ì •ì‚°</h2>
            </div>
            
            <div class="p-6 overflow-y-auto flex-grow">
                <div id="results-section" class="space-y-8">
                    <div>
                        <h3 class="text-xl font-semibold mb-3 text-gray-700">ì–»ì€ ë¶€ì‚°ë¬¼ (ì „ì²´ í•©ê³„)</h3>
                        <div class="overflow-hidden border border-gray-200 rounded-lg">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ë¶€ì‚°ë¬¼</th>
                                        <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">ê°œìˆ˜</th>
                                    </tr>
                                </thead>
                                <tbody id="item-table-body" class="bg-white divide-y divide-gray-200"></tbody>
                            </table>
                        </div>
                    </div>
                    <div>
                        <h3 id="session-label" class="text-xl font-semibold mb-3 text-gray-700">ìƒì§ ì‹œê°„</h3>
                        <div class="overflow-hidden border border-gray-200 rounded-lg">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">ì„¸ì…˜</th>
                                        <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">ì‹œì‘</th>
                                        <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">ì¢…ë£Œ</th>
                                        <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">ë¶„</th>
                                    </tr>
                                </thead>
                                <tbody id="session-table-body" class="bg-white divide-y divide-gray-200"></tbody>
                            </table>
                        </div>
                    </div>

                    <div id="fishing-info-box" class="bg-gray-50 p-4 rounded-lg flex-wrap items-center justify-center space-x-6 hidden">
                        <p id="crab-count-label" class="text-sm text-gray-700"><span class="font-semibold">ë§Œë‚œ ê²Œ :</span> 0 ë§ˆë¦¬</p>
                        <p id="minigame-count-label" class="text-sm text-gray-700"><span class="font-semibold">ì§„í–‰í•œ ë¯¸ë‹ˆê²Œì„ :</span> 0 ë²ˆ</p>
                    </div>

                    <div class="bg-gray-50 p-4 rounded-lg flex flex-wrap items-center justify-center space-x-6">
                        <img src="images/coin.png" alt="ì½”ì¸ ì•„ì´ì½˜" class="w-6 h-6">
                        <p id="earned-label" class="text-sm text-gray-700"><span class="font-semibold">ë²ˆ ëˆ :</span> 0 ì½”ì¸</p>
                        <p id="spent-label" class="text-sm text-gray-700"><span class="font-semibold">ì“´ ëˆ :</span> 0 ì½”ì¸</p>
                    </div>
                </div>
            </div>
             <div class="p-4 bg-gray-50 border-t text-right">
                <p class="text-sm text-gray-500">ì´ ì°½ì€ ìƒˆë¡œê³ ì¹¨í•´ë„ ê²°ê³¼ê°€ ìœ ì§€ë©ë‹ˆë‹¤.</p>
            </div>
        </div>
    </div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const IMAGE_BASE_URL = "images/";
    const JOB_DATA = { "ì–´ë¶€": { "title": "ì˜¤ë‚šë (ì–´ë¶€)", "menu_icon": "menuicon1.png", "items": [ "ë¬¼ì˜ ì›ì†Œ ê°€ë£¨", "ë¬¼ì˜ ì›ì†Œ ì¡°ê°", "ë¬¼ì˜ ì›ì†Œ ì •ìˆ˜", "ì§„ì£¼", "í–‰ìš´ì˜ í¸ì§€", "í•´ì ì˜ ë³´ë¬¼ìƒì", "ë§ˆë…€ì˜ ëˆˆë¬¼", "ìš©ì™•ì˜ ì™•ê´€", "ì‹¤ì¢…ëœ ì ìˆ˜ë¶€ í—¬ë©§", "ê³ ëŒ€ ë¬¼ì˜ ì˜í˜¼ì„", "ë¬¼ì˜ ì •ë ¹ì˜ ìœ ë¦¬êµ¬ë‘", "ê³ ê¸‰ ì–´ë¶€ ìƒì" ] }, "ê´‘ë¶€": { "title": "ì˜¤ê´‘ë (ê´‘ë¶€)", "menu_icon": "menuicon2.png", "items": [ "ë•…ì˜ ì›ì†Œ ê°€ë£¨", "ë•…ì˜ ì›ì†Œ ì¡°ê°", "ë•…ì˜ ì›ì†Œ ì •ìˆ˜", "ê°€ë„·", "ì•„ì¿ ì•„ë§ˆë¦°", "í† íŒŒì¦ˆ", "í˜ë¦¬ë„íŠ¸", "ì•”ëª¨ë‚˜ì´íŠ¸ í™”ì„", "ê±°ë¯¸ í™”ì„", "ë¬¼ê³ ê¸° í™”ì„", "ê³µë£¡ì•Œ í™”ì„", "ì†”ë¼ì´íŠ¸ ì›ì„", "ì‹¤ì¢…ëœ ê´‘ë¶€ì˜ í‘œë³¸ìƒ˜í”Œ", "ê³ ëŒ€ì˜ í”¼ë¼ë¯¸ë“œ íë¸Œ", "ëŒ€ì§€ì˜ ì •ë ¹ì˜ í˜¸ë°•í™”ì„", "ê³ ê¸‰ ê´‘ë¶€ ìƒì" ] }, "ë†ë¶€": { "title": "ì˜¤ë†ë (ë†ë¶€)", "menu_icon": "menuicon3.png", "items": [ "ë¶ˆì˜ ì›ì†Œ ê°€ë£¨", "ë¶ˆì˜ ì›ì†Œ ì¡°ê°", "ë¶ˆì˜ ì›ì†Œ ì •ìˆ˜", "ì• ë²Œë ˆ", "ë¬´ë‹¹ë²Œë ˆ", "ë©”ëšœê¸°", "ë”±ì •ë²Œë ˆ", "ë°€ ë²ˆë“¤", "ëŒ€ë‚˜ë¬´ ë²ˆë“¤", "ë¹„íŠ¸ ë²ˆë“¤", "ê°ì ë²ˆë“¤", "ê°ˆìƒ‰ ë²„ì„¯ ë²ˆë“¤", "ë¹¨ê°„ ë²„ì„¯ ë²ˆë“¤", "ì„ ì¸ì¥ ë²ˆë“¤", "ë‹¹ê·¼ ë²ˆë“¤", "í›„ë ´í™” ë²ˆë“¤", "ì½”ì½”ì•„ì½© ë²ˆë“¤", "ë„¤ë”ì™€íŠ¸ ë²ˆë“¤", "ì‚¬íƒ•ìˆ˜ìˆ˜ ë²ˆë“¤", "ì¼ˆí”„ ë²ˆë“¤", "ìˆ˜ë°• ì¡°ê° ë²ˆë“¤", "ë‹¬ì½¤í•œ ì—´ë§¤ ë²ˆë“¤", "ê°œëŸ‰ëœ ëª©í™”ì†œ", "ì‹¤ì¢…ëœ ë†ë¶€ì˜ ë•…ë¬¸ì„œ", "ê³ ëŒ€ì‹ë¬¼ì˜ ëª¨ì¢…", "ë¶ˆì˜ ì •ë ¹ì˜ ê½ƒ í™”ê´€", "ê³ ê¸‰ ë†ë¶€ ìƒì" ] }, "ë‚˜ë¬´ê¾¼": { "title": "ì˜¤ë‚˜ë (ë‚˜ë¬´ê¾¼)", "menu_icon": "menuicon4.png", "items": [ "ë°”ëŒì˜ ì›ì†Œ ê°€ë£¨", "ë°”ëŒì˜ ì›ì†Œ ì¡°ê°", "ë°”ëŒì˜ ì›ì†Œ ì •ìˆ˜", "ë‚˜ë¬´ê»ì§ˆ", "ê³ ëª©ë‚˜ë¬´ ìˆ˜ì•¡", "ë§¨ë“œë ˆì´í¬", "ë°”ì˜¤ë°¥ë‚˜ë¬´ ë¿Œë¦¬", "ì†¡ì´ë²„ì„¯", "ë¶ˆë¡œì´ˆ", "ì„¤ì‚¼", "í™©ê¸ˆë²„ì„¯", "ì›ì‹œë¶€ì¡± ê°€ë©´", "ì‹¤ì¢…ëœ ë‚˜ë¬´ê¾¼ì˜ ì¥ê°‘", "ê³ ëŒ€ ì •ë ¹ì˜ ë©”ì•„ë¦¬", "ë‚˜ë¬´ì˜ ì •ë ¹ì˜ ì—°ê½ƒ ì°»ì”", "ê³ ê¸‰ ë‚˜ë¬´ê¾¼ ìƒì" ] }, "ì‚¬ëƒ¥ê¾¼": { "title": "ì˜¤ëƒ¥ë (ì‚¬ëƒ¥ê¾¼)", "menu_icon": "menuicon5.png", "items": [ "ì˜í˜¼ì˜ ì›ì†Œ ê°€ë£¨", "ì˜í˜¼ì˜ ì›ì†Œ ì¡°ê°", "ì˜í˜¼ì˜ ì›ì†Œ ì •ìˆ˜", "ì§ìŠ¹ì˜ ì†¡ê³³ë‹ˆ", "ì§ìŠ¹ì˜ ê°€ì£½", "ì§ìŠ¹ì˜ ê¼¬ë¦¬", "ë…ì¹¨", "ìš©ì˜ í”¼", "ëŒ€ì§€ì˜ ê²°ì •ì²´", "ë¶€ë“œëŸ¬ìš´ ê¹ƒí„¸", "ë¶€ë“œëŸ¬ìš´ í„¸", "ë²„ì„¯ ê³ ê¸°", "ë°”ëŒì˜ ê²°ì •ì²´", "ë¬¼ë°©ìš¸ì˜ ë³„", "ê³µí—ˆì˜ íŒŒë™", "ëŒê³ ë˜ì˜ ë§ˆìŒ", "ë¬¼ì˜ ê²°ì •ì²´", "ë„˜ì‹¤ê±°ë¦¬ëŠ” ë¶ˆê½ƒ", "ê°€ìŠ¤íŠ¸ì˜ íŒŒí¸", "ë¶ˆì˜ ê²°ì •ì²´", "ë”ëŸ¬ìš´ ì²œ", "ì—”ë” ì§„ì£¼ ê°€ë£¨", "ì‚¬ì•…í•œ ê¸°ìš´", "ìˆ˜ìƒí•œ ì£¼ë¨¸ë‹ˆ", "íƒ€ë½í•œ ì›”ê³„ìˆ˜ ì", "íƒ€ë½í•œ ìš”ì •ì˜ ê°€ë£¨", "ì–´ë‘ ì˜ ê²°ì •ì²´", "ë¯¸ìŠ¤í‹± ì½”ì–´", "ê°ˆë¹„ë¼ˆ", "ìš”ì •ì˜ ê°€ë£¨", "ë¹›ì˜ ê²°ì •ì²´", "ì‹ ë¹„í•œ ë™ë¬¼ ê°€ì£½", "ì‹¤ì¢…ëœ ì‚¬ëƒ¥ê¾¼ ê³ ê¸€", "ê³ ëŒ€ ë§˜ëª¨ìŠ¤ ë¿”", "ì–´ë‘ ì˜ ì •ë ¹ì˜ ë¶€ëŸ¬ì§„ ìŠ¤íƒœí”„", "ê³ ê¸‰ ì‚¬ëƒ¥ê¾¼ ìƒì", "ì‹¤", "ì•ˆì¥", "ê³ ì‚¬ë¦¬", "ìŠ¬ë¼ì„ë³¼", "ê¹ƒí„¸", "ì í†  ë©ì´", "ë§ˆë¥¸ ë¤ë¶ˆ", "ë°œê´‘ì„ ê°€ë£¨", "ë ˆë“œìŠ¤í†¤ ê°€ë£¨", "ë¼ˆë‹¤ê·€", "í™”ì•½", "ë°”ë‹¤ì˜ ì‹¬ì¥", "ì¸ê°‘", "ì „ë‹¬ì²´", "í”„ë¦¬ì¦ˆë¨¸ë¦° ìˆ˜ì •", "í”„ë¦¬ì¦ˆë¨¸ë¦° ì¡°ê°", "ë¨¹ë¬¼ ì£¼ë¨¸ë‹ˆ", "ë°œê´‘ ë¨¹ë¬¼ ì£¼ë¨¸ë‹ˆ", "ì –ì€ ìŠ¤í€ì§€", "ê°€ì£½", "í™”ì—¼êµ¬", "ìœ„ë” ì¥ë¯¸", "ë¸”ë ˆì´ì¦ˆ ë§‰ëŒ€ê¸°", "ë²Œë ˆ ë¨¹ì€ ëŒ", "ì—”ë” ì§„ì£¼", "ì…œì»¤ ê»ë°ê¸°", "ê±°ë¯¸ì¤„" ] } };
    const FILENAME_MAP = { "ë¬¼ì˜ ì›ì†Œ ê°€ë£¨": "water_elemental_powder", "ë¬¼ì˜ ì›ì†Œ ì¡°ê°": "water_elemental_shard", "ë¬¼ì˜ ì›ì†Œ ì •ìˆ˜": "water_elemental_essence", "ì§„ì£¼": "pearl", "í–‰ìš´ì˜ í¸ì§€": "lucky_letter", "í•´ì ì˜ ë³´ë¬¼ìƒì": "pirate_treasure_box", "ë§ˆë…€ì˜ ëˆˆë¬¼": "witch_tear", "ìš©ì™•ì˜ ì™•ê´€": "dragon_king_crown", "ì‹¤ì¢…ëœ ì ìˆ˜ë¶€ í—¬ë©§": "missing_diver_helmet", "ê³ ëŒ€ ë¬¼ì˜ ì˜í˜¼ì„": "ancient_water_soulstone", "ë¬¼ì˜ ì •ë ¹ì˜ ìœ ë¦¬êµ¬ë‘": "water_spirit_glass_slipper", "ê³ ê¸‰ ì–´ë¶€ ìƒì": "advanced_fisher_box", "ë•…ì˜ ì›ì†Œ ê°€ë£¨": "earth_elemental_powder", "ë•…ì˜ ì›ì†Œ ì¡°ê°": "earth_elemental_shard", "ë•…ì˜ ì›ì†Œ ì •ìˆ˜": "earth_elemental_essence", "ê°€ë„·": "garnet", "ì•„ì¿ ì•„ë§ˆë¦°": "aquamarine", "í† íŒŒì¦ˆ": "topaz", "í˜ë¦¬ë„íŠ¸": "peridot", "ì•”ëª¨ë‚˜ì´íŠ¸ í™”ì„": "ammonite_fossil", "ê±°ë¯¸ í™”ì„": "spider_fossil", "ë¬¼ê³ ê¸° í™”ì„": "fish_fossil", "ê³µë£¡ì•Œ í™”ì„": "dino_egg_fossil", "ì†”ë¼ì´íŠ¸ ì›ì„": "solite_ore", "ì‹¤ì¢…ëœ ê´‘ë¶€ì˜ í‘œë³¸ìƒ˜í”Œ": "missing_miner_sample", "ê³ ëŒ€ì˜ í”¼ë¼ë¯¸ë“œ íë¸Œ": "ancient_pyramid_cube", "ëŒ€ì§€ì˜ ì •ë ¹ì˜ í˜¸ë°•í™”ì„": "earth_spirit_amber_fossil", "ê³ ê¸‰ ê´‘ë¶€ ìƒì": "advanced_miner_box", "ë¶ˆì˜ ì›ì†Œ ê°€ë£¨": "fire_elemental_powder", "ë¶ˆì˜ ì›ì†Œ ì¡°ê°": "fire_elemental_shard", "ë¶ˆì˜ ì›ì†Œ ì •ìˆ˜": "fire_elemental_essence", "ì• ë²Œë ˆ": "caterpillar", "ë¬´ë‹¹ë²Œë ˆ": "ladybug", "ë©”ëšœê¸°": "grasshopper", "ë”±ì •ë²Œë ˆ": "beetle", "ë°€ ë²ˆë“¤": "wheat_bundle", "ëŒ€ë‚˜ë¬´ ë²ˆë“¤": "bamboo_bundle", "ë¹„íŠ¸ ë²ˆë“¤": "beet_bundle", "ê°ì ë²ˆë“¤": "potato_bundle", "ê°ˆìƒ‰ ë²„ì„¯ ë²ˆë“¤": "brown_mushroom_bundle", "ë¹¨ê°„ ë²„ì„¯ ë²ˆë“¤": "red_mushroom_bundle", "ì„ ì¸ì¥ ë²ˆë“¤": "cactus_bundle", "ë‹¹ê·¼ ë²ˆë“¤": "carrot_bundle", "í›„ë ´í™” ë²ˆë“¤": "chorus_flower_bundle", "ì½”ì½”ì•„ì½© ë²ˆë“¤": "cocoa_beans_bundle", "ë„¤ë”ì™€íŠ¸ ë²ˆë“¤": "nether_wart_bundle", "ì‚¬íƒ•ìˆ˜ìˆ˜ ë²ˆë“¤": "sugar_cane_bundle", "ì¼ˆí”„ ë²ˆë“¤": "kelp_bundle", "ìˆ˜ë°• ì¡°ê° ë²ˆë“¤": "melon_slice_bundle", "ë‹¬ì½¤í•œ ì—´ë§¤ ë²ˆë“¤": "sweet_berries_bundle", "ê°œëŸ‰ëœ ëª©í™”ì†œ": "improved_cotton", "ì‹¤ì¢…ëœ ë†ë¶€ì˜ ë•…ë¬¸ì„œ": "missing_farmer_deed", "ê³ ëŒ€ì‹ë¬¼ì˜ ëª¨ì¢…": "ancient_plant_seedling", "ë¶ˆì˜ ì •ë ¹ì˜ ê½ƒ í™”ê´€": "fire_spirit_flower_crown", "ê³ ê¸‰ ë†ë¶€ ìƒì": "advanced_farmer_box", "ë°”ëŒì˜ ì›ì†Œ ê°€ë£¨": "wind_elemental_powder", "ë°”ëŒì˜ ì›ì†Œ ì¡°ê°": "wind_elemental_shard", "ë°”ëŒì˜ ì›ì†Œ ì •ìˆ˜": "wind_elemental_essence", "ë‚˜ë¬´ê»ì§ˆ": "tree_bark", "ê³ ëª©ë‚˜ë¬´ ìˆ˜ì•¡": "old_tree_sap", "ë§¨ë“œë ˆì´í¬": "mandrake", "ë°”ì˜¤ë°¥ë‚˜ë¬´ ë¿Œë¦¬": "baobab_root", "ì†¡ì´ë²„ì„¯": "pine_mushroom", "ë¶ˆë¡œì´ˆ": "herb_of_immortality", "ì„¤ì‚¼": "snow_ginseng", "í™©ê¸ˆë²„ì„¯": "golden_mushroom", "ì›ì‹œë¶€ì¡± ê°€ë©´": "primitive_tribe_mask", "ì‹¤ì¢…ëœ ë‚˜ë¬´ê¾¼ì˜ ì¥ê°‘": "missing_logger_gloves", "ê³ ëŒ€ ì •ë ¹ì˜ ë©”ì•„ë¦¬": "ancient_spirit_echo", "ë‚˜ë¬´ì˜ ì •ë ¹ì˜ ì—°ê½ƒ ì°»ì”": "tree_spirit_lotus_teacup", "ê³ ê¸‰ ë‚˜ë¬´ê¾¼ ìƒì": "advanced_logger_box", "ì˜í˜¼ì˜ ì›ì†Œ ê°€ë£¨": "soul_elemental_powder", "ì˜í˜¼ì˜ ì›ì†Œ ì¡°ê°": "soul_elemental_shard", "ì˜í˜¼ì˜ ì›ì†Œ ì •ìˆ˜": "soul_elemental_essence", "ì§ìŠ¹ì˜ ì†¡ê³³ë‹ˆ": "beast_fang", "ì§ìŠ¹ì˜ ê°€ì£½": "beast_hide", "ì§ìŠ¹ì˜ ê¼¬ë¦¬": "beast_tail", "ë…ì¹¨": "poison_sting", "ìš©ì˜ í”¼": "dragon_blood", "ëŒ€ì§€ì˜ ê²°ì •ì²´": "earth_crystal", "ë¶€ë“œëŸ¬ìš´ ê¹ƒí„¸": "soft_feather", "ë¶€ë“œëŸ¬ìš´ í„¸": "soft_fur", "ë²„ì„¯ ê³ ê¸°": "mushroom_meat", "ë°”ëŒì˜ ê²°ì •ì²´": "wind_crystal", "ë¬¼ë°©ìš¸ì˜ ë³„": "waterdrop_star", "ê³µí—ˆì˜ íŒŒë™": "void_wave", "ëŒê³ ë˜ì˜ ë§ˆìŒ": "dolphin_heart", "ë¬¼ì˜ ê²°ì •ì²´": "water_crystal", "ë„˜ì‹¤ê±°ë¦¬ëŠ” ë¶ˆê½ƒ": "waving_flame", "ê°€ìŠ¤íŠ¸ì˜ íŒŒí¸": "ghast_fragment", "ë¶ˆì˜ ê²°ì •ì²´": "fire_crystal", "ë”ëŸ¬ìš´ ì²œ": "dirty_cloth", "ì—”ë” ì§„ì£¼ ê°€ë£¨": "ender_pearl_powder", "ì‚¬ì•…í•œ ê¸°ìš´": "evil_energy", "ìˆ˜ìƒí•œ ì£¼ë¨¸ë‹ˆ": "suspicious_pouch", "íƒ€ë½í•œ ì›”ê³„ìˆ˜ ì": "corrupted_laurel_leaf", "íƒ€ë½í•œ ìš”ì •ì˜ ê°€ë£¨": "corrupted_fairy_powder", "ì–´ë‘ ì˜ ê²°ì •ì²´": "dark_crystal", "ë¯¸ìŠ¤í‹± ì½”ì–´": "mystic_core", "ê°ˆë¹„ë¼ˆ": "rib_bone", "ìš”ì •ì˜ ê°€ë£¨": "fairy_powder", "ë¹›ì˜ ê²°ì •ì²´": "light_crystal", "ì‹ ë¹„í•œ ë™ë¬¼ ê°€ì£½": "mystical_animal_hide", "ì‹¤ì¢…ëœ ì‚¬ëƒ¥ê¾¼ ê³ ê¸€": "missing_hunter_goggles", "ê³ ëŒ€ ë§˜ëª¨ìŠ¤ ë¿”": "ancient_mammoth_horn", "ì–´ë‘ ì˜ ì •ë ¹ì˜ ë¶€ëŸ¬ì§„ ìŠ¤íƒœí”„": "dark_spirit_broken_staff", "ê³ ê¸‰ ì‚¬ëƒ¥ê¾¼ ìƒì": "advanced_hunter_box", "ì‹¤": "string", "ì•ˆì¥": "saddle", "ê³ ì‚¬ë¦¬": "fern", "ìŠ¬ë¼ì„ë³¼": "slimeball", "ê¹ƒí„¸": "feather", "ì í†  ë©ì´": "clay_ball", "ë§ˆë¥¸ ë¤ë¶ˆ": "dead_bush", "ë°œê´‘ì„ ê°€ë£¨": "glowstone_dust", "ë ˆë“œìŠ¤í†¤ ê°€ë£¨": "redstone_dust", "ë¼ˆë‹¤ê·€": "bone", "í™”ì•½": "gunpowder", "ë°”ë‹¤ì˜ ì‹¬ì¥": "heart_of_the_sea", "ì¸ê°‘": "scute", "ì „ë‹¬ì²´": "conduit", "í”„ë¦¬ì¦ˆë¨¸ë¦° ìˆ˜ì •": "prismarine_crystals", "í”„ë¦¬ì¦ˆë¨¸ë¦° ì¡°ê°": "prismarine_shard", "ë¨¹ë¬¼ ì£¼ë¨¸ë‹ˆ": "ink_sac", "ë°œê´‘ ë¨¹ë¬¼ ì£¼ë¨¸ë‹ˆ": "glow_ink_sac", "ì –ì€ ìŠ¤í€ì§€": "wet_sponge", "ê°€ì£½": "leather", "í™”ì—¼êµ¬": "fire_charge", "ìœ„ë” ì¥ë¯¸": "wither_rose", "ë¸”ë ˆì´ì¦ˆ ë§‰ëŒ€ê¸°": "blaze_rod", "ë²Œë ˆ ë¨¹ì€ ëŒ": "infested_stone", "ì—”ë” ì§„ì£¼": "ender_pearl", "ì…œì»¤ ê»ë°ê¸°": "shulker_shell", "ê±°ë¯¸ì¤„": "cobweb" };

    let fullResultData = null;
    let currentJob = sessionStorage.getItem('currentJob');

    const sessionTableBody = document.getElementById('session-table-body');

    function formatCount(count) { if (count < 64) return `${count}`; const shulkerSize = 64 * 27; if (count >= shulkerSize) { const numShulkers = Math.floor(count / shulkerSize); const rem = count % shulkerSize; const numSets = Math.floor(rem / 64); const remInd = rem % 64; return `${count} (${numShulkers}ì…œì»¤ ${numSets}ì…‹ ${remInd}ê°œ)`; } else { const numSets = Math.floor(count / 64); const remInd = count % 64; return `${count} (${numSets}ì…‹ ${remInd}ê°œ)`; } }

    function displayResults(results, jobName) {
        const { totalItemCounts, sessions, coinsEarned, coinsSpent, firstLogTime, lastLogTime, crabCount, minigameCount, totalRankingPointGain, uniqueDates } = results;
        const currentJobData = JOB_DATA[jobName];
    
        const titleDateString = (() => {
            if (!uniqueDates || uniqueDates.length === 0) return "";
            
            const formattedDates = uniqueDates.map(d => {
                const date = new Date(d);
                return `${date.getFullYear()}.${String(date.getMonth() + 1).padStart(2, '0')}.${String(date.getDate()).padStart(2, '0')}`;
            });

            let isContinuous = true;
            for (let i = 0; i < uniqueDates.length - 1; i++) {
                const currentDate = new Date(uniqueDates[i]);
                const nextDate = new Date(uniqueDates[i+1]);
                const diffTime = nextDate - currentDate;
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                if (diffDays > 1) {
                    isContinuous = false;
                    break;
                }
            }

            if (uniqueDates.length <= 2 && isContinuous) {
                const start = firstLogTime ? new Date(firstLogTime).toLocaleDateString('ko-KR', { year: 'numeric', month: '2-digit', day: '2-digit'}).replace(/\. /g, '.').slice(0,-1) : "";
                const end = lastLogTime ? new Date(lastLogTime).toLocaleDateString('ko-KR', { year: 'numeric', month: '2-digit', day: '2-digit'}).replace(/\. /g, '.').slice(0,-1) : "";
                if (start === end) return start;
                return start && end ? `${start} ~ ${end}` : "ë¶„ì„ ê²°ê³¼";
            } else {
                 return formattedDates.join(', ');
            }
        })();
    
        document.getElementById('page-title').innerHTML = `${currentJobData.title} <span class="text-base text-gray-500 font-normal">${titleDateString}</span>`;
        document.title = `${currentJobData.title} - ${titleDateString}`;
    
        const itemTableBody = document.getElementById('item-table-body');
        itemTableBody.innerHTML = '';
        const sortedTotalItems = currentJobData.items.filter(name => totalItemCounts[name] > 0);
        
        if (sortedTotalItems.length > 0) {
            sortedTotalItems.forEach(name => {
                const tr = document.createElement('tr');
                tr.innerHTML = `<td class="px-6 py-4 whitespace-nowrap"><div class="flex items-center"><div class="flex-shrink-0 h-6 w-6"><img class="h-6 w-6 object-contain" src="${IMAGE_BASE_URL}${FILENAME_MAP[name] || name}.png" onerror="this.src='https://placehold.co/48x48/cccccc/ffffff?text=?';"></div><div class="ml-4 flex items-center"><div class="text-sm font-medium text-gray-900">${name}</div></div></div></td><td class="px-6 py-4 whitespace-nowrap text-center text-sm text-gray-500">${formatCount(totalItemCounts[name])}</td>`;
                itemTableBody.appendChild(tr);
            });
        } else {
            itemTableBody.innerHTML = `<tr><td colspan="2" class="text-center px-6 py-4 text-gray-500">íšë“í•œ ë¶€ì‚°ë¬¼ì´ ì—†ìŠµë‹ˆë‹¤.</td></tr>`;
        }
    
        sessionTableBody.innerHTML = '';
        let totalMinutes = 0;
        const parsedSessions = sessions.map(s => ({ ...s, start: new Date(s.start), end: new Date(s.end) }));
    
        if (parsedSessions.length > 0) {
            parsedSessions.forEach((session, idx) => {
                const duration = Math.max(1, Math.floor((session.end.getTime() - session.start.getTime()) / 60000));
                totalMinutes += duration;
                const tr = document.createElement('tr');
                tr.className = 'session-row';
                tr.dataset.index = idx;
                
                const formatMDTime = (date) => {
                    if (!(date instanceof Date) || isNaN(date)) return 'ìœ íš¨í•˜ì§€ ì•Šì€ ì‹œê°„';
                    return `${date.getMonth() + 1}/${date.getDate()} ${date.toLocaleTimeString('ko-KR')}`;
                };
                const startTimeString = formatMDTime(session.start);
                const endTimeString = formatMDTime(session.end);
    
                tr.innerHTML = `<td class="px-6 py-4 whitespace-nowrap text-center text-sm text-gray-500">${idx + 1}</td><td class="px-6 py-4 whitespace-nowrap text-center text-sm text-gray-500">${startTimeString}</td><td class="px-6 py-4 whitespace-nowrap text-center text-sm text-gray-500">${endTimeString}</td><td class="px-6 py-4 whitespace-nowrap text-center text-sm text-gray-500">${duration}</td>`;
                sessionTableBody.appendChild(tr);
            });
        } else {
            sessionTableBody.innerHTML = `<tr><td colspan="4" class="text-center px-6 py-4 text-gray-500">ê¸°ë¡ëœ ì„¸ì…˜ì´ ì—†ìŠµë‹ˆë‹¤.</td></tr>`;
        }
    
        const rankingPointGainText = totalRankingPointGain ? ` <span class="text-sm text-green-600 font-normal">(+${totalRankingPointGain.toFixed(1).replace(/\.0$/, '')}ì )</span>` : "";
        document.getElementById('session-label').innerHTML = `ìƒì§ ì‹œê°„ (ì´ ${totalMinutes}ë¶„)${rankingPointGainText}`;
        
        if (jobName === "ì–´ë¶€") {
            const fishingBox = document.getElementById('fishing-info-box');
            if (fishingBox) fishingBox.classList.remove('hidden');
            document.getElementById('crab-count-label').innerHTML = `<span class="font-semibold">ë§Œë‚œ ê²Œ :</span> ${crabCount} ë§ˆë¦¬`;
            document.getElementById('minigame-count-label').innerHTML = `<span class="font-semibold">ì§„í–‰í•œ ë¯¸ë‹ˆê²Œì„ :</span> ${minigameCount} ë²ˆ`;
        }
        
        document.getElementById('earned-label').innerHTML = `<span class="font-semibold">ë²ˆ ëˆ :</span> ${coinsEarned.toLocaleString('ko-KR', { maximumFractionDigits: 0 })} ì½”ì¸`;
        document.getElementById('spent-label').innerHTML = `<span class="font-semibold">ì“´ ëˆ :</span> ${coinsSpent.toLocaleString('ko-KR', { maximumFractionDigits: 0 })} ì½”ì¸`;
    }

    function toggleSessionDetails(event) {
        const row = event.target.closest('.session-row');
        if (!row) return;

        const existingDetailRow = document.querySelector('.session-details');
        if (existingDetailRow) {
            const parentRow = existingDetailRow.previousElementSibling;
            parentRow.classList.remove('bg-blue-50', 'font-semibold');
            const wasThisRow = parentRow === row;
            existingDetailRow.remove();
            if (wasThisRow) return;
        }
        
        row.classList.add('bg-blue-50', 'font-semibold');
        const sessionIndex = parseInt(row.dataset.index, 10);
        const session = fullResultData.sessions[sessionIndex];
        const sessionItems = session.items;
        
        const sortedSessionItems = JOB_DATA[currentJob].items.filter(itemName => sessionItems[itemName] > 0);

        let detailsHtml = `<div class="bg-gray-50/50 p-4">`;
        
        if (sortedSessionItems.length > 0) {
            detailsHtml += `<table class="min-w-full bg-white details-table"><tbody>`;
            sortedSessionItems.forEach(itemName => {
                const imageUrl = `${IMAGE_BASE_URL}${FILENAME_MAP[itemName] || itemName}.png`;
                detailsHtml += `<tr>
                    <td class="px-6 py-3 whitespace-nowrap">
                        <div class="flex items-center">
                            <div class="flex-shrink-0 h-5 w-5 transform -translate-y-px">
                                <img class="h-5 w-5 object-contain" src="${imageUrl}" onerror="this.src='https.placehold.co/48x48/cccccc/ffffff?text=?';">
                            </div>
                            <div class="ml-3 flex items-center">
                                <div class="text-sm font-medium text-gray-900">${itemName}</div>
                            </div>
                        </div>
                    </td>
                    <td class="px-6 py-3 whitespace-nowrap text-center text-sm text-gray-500">${formatCount(sessionItems[itemName])}</td>
                </tr>`;
            });
            detailsHtml += '</tbody></table></div>';
        } else {
            detailsHtml += '<p class="text-center text-gray-500 py-4">ì´ ì„¸ì…˜ì—ì„œ íšë“í•œ ë¶€ì‚°ë¬¼ì´ ì—†ìŠµë‹ˆë‹¤.</p></div>';
        }

        const detailRow = document.createElement('tr');
        detailRow.className = 'session-details';
        detailRow.innerHTML = `<td colspan="4">${detailsHtml}</td>`;
        row.after(detailRow);
    }

    sessionTableBody.addEventListener('click', toggleSessionDetails);

    const resultDataJSON = sessionStorage.getItem('analysisResult');

    if (resultDataJSON && currentJob) {
        try {
            fullResultData = JSON.parse(resultDataJSON);
            displayResults(fullResultData, currentJob);
        } catch (e) {
            console.error("ê²°ê³¼ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.", e);
            document.getElementById('results-section').innerHTML = '<p class="text-center text-red-500">ê²°ê³¼ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</p>';
        }
    } else {
         document.getElementById('results-section').innerHTML = '<p class="text-center text-gray-500">í‘œì‹œí•  ë¶„ì„ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤. ë©”ì¸ í˜ì´ì§€ì—ì„œ ë¡œê·¸ íŒŒì¼ì„ ë¨¼ì € ë¶„ì„í•´ì£¼ì„¸ìš”.</p>';
    }
});
</script>
</body>
</html>
